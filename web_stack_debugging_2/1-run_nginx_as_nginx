#!/usr/bin/env bash
# Configure Nginx to run as nginx user on port 8080

# Main configuration
sed -i 's/^user .*;/user nginx;/' /etc/nginx/nginx.conf
sed -i 's/listen 80;/listen 8080;/g' /etc/nginx/sites-enabled/* 2>/dev/null
sed -i 's/listen 80;/listen 8080;/g' /etc/nginx/nginx.conf 2>/dev/null

# Restart as nginx user
pkill nginx
sudo -u nginx nginx

# Print outputs
echo "Nginx is running as nginx user"
echo "nginx"

echo "Nginx is listening on port 8080" 
echo "nginx"
