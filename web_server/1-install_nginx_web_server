#!/usr/bin/env bash
# Installs Nginx, sets root page to 'Holberton School for the win!', ensures it runs on port 80

# Update package lists
apt-get update -y

# Install Nginx
apt-get install -y nginx

# Ensure the web root directory exists
mkdir -p /var/www/html

# Remove default index if it exists
rm -f /var/www/html/index.nginx-debian.html

# Create the required index.html with correct content
echo "Holberton School for the win!" > /var/www/html/index.html

# Set permissions so Nginx can serve the page
chown -R www-data:www-data /var/www/html
chmod -R 755 /var/www/html

# Make sure the default Nginx site config points to /var/www/html
sed -i 's|root /var/www/html;|root /var/www/html;|' /etc/nginx/sites-available/default

# Start or restart Nginx safely without systemctl
service nginx start || service nginx restart
